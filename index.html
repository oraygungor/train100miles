<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Paradox: Visual Proof</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #2563EB;
            margin-top: -6px;
            cursor: pointer;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            background: #E5E7EB;
            border-radius: 2px;
        }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 min-h-screen flex flex-col items-center py-10 px-4">

    <!-- Minimal Header -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-slate-900 tracking-tight">The Train Paradox</h1>
        <p class="text-slate-500 mt-2 text-sm">Condition: Every 1-hour interval covers exactly 100 miles.</p>
    </div>

    <!-- Main Card -->
    <div class="bg-white p-2 rounded-2xl shadow-lg border border-gray-100 max-w-4xl w-full">
        
        <!-- Canvas Wrapper -->
        <div class="relative w-full aspect-[16/9] md:aspect-[21/9] lg:h-[400px]">
            <canvas id="trainChart" class="w-full h-full rounded-xl"></canvas>
            
            <!-- Minimal Legend (Moved Down) -->
            <div class="absolute top-16 left-14 bg-white/80 backdrop-blur text-[10px] md:text-xs p-2 rounded border border-gray-200 shadow-sm">
                <div class="flex items-center gap-2 mb-1">
                    <span class="w-2 h-2 rounded-full bg-blue-600"></span> Actual Path
                </div>
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-red-500"></span> Avg Speed
                </div>
            </div>
        </div>

        <!-- Controls & Results -->
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-8 items-center border-t border-gray-100 mt-2">
            
            <!-- Left: Slider Control -->
            <div>
                <div class="flex justify-between text-sm font-semibold text-slate-700 mb-4">
                    <span>Speed Variance</span>
                    <span id="varianceVal" class="font-mono text-blue-600">0%</span>
                </div>
                <input type="range" id="varianceSlider" min="-100" max="100" value="0" step="1">
                <div class="flex justify-between text-[10px] text-gray-400 mt-2 uppercase tracking-wide">
                    <span>Constant Speed</span>
                    <span>Variable Speed</span>
                </div>
                
                <div class="mt-6 flex items-center justify-between bg-slate-50 p-3 rounded-lg border border-slate-100">
                     <span class="text-xs font-bold text-slate-500 uppercase">Scanner</span>
                     <button id="toggleScannerBtn" class="text-xs font-semibold bg-white border border-gray-300 px-3 py-1.5 rounded shadow-sm hover:bg-gray-50 transition">
                        Pause
                    </button>
                </div>
            </div>

            <!-- Right: The Answers -->
            <div class="space-y-4">
                <!-- Question A -->
                <div class="flex justify-between items-center border-b border-gray-100 pb-3">
                    <div class="text-sm text-slate-600 pr-4">
                        (a) Is velocity necessarily constant?
                    </div>
                    <div id="ansA" class="text-sm font-bold bg-gray-100 text-gray-500 px-3 py-1 rounded">
                        YES
                    </div>
                </div>

                <!-- Question B -->
                <div class="flex justify-between items-center border-b border-gray-100 pb-3">
                    <div class="text-sm text-slate-600 pr-4">
                        (b) Is avg speed necessarily 100 mph?
                    </div>
                    <div id="ansB" class="text-sm font-bold bg-gray-100 text-gray-500 px-3 py-1 rounded">
                        YES
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 gap-4 pt-1">
                    <!-- Real Average Speed -->
                    <div>
                        <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-1">Avg Speed (Total)</span>
                        <div class="text-xl font-bold text-slate-900">
                            <span id="avgSpeedDisplay">100.0</span> <span class="text-xs font-normal text-slate-500">mph</span>
                        </div>
                    </div>

                    <!-- Instant Speed -->
                    <div>
                        <span class="text-[10px] font-bold text-blue-500 uppercase tracking-wider block mb-1">Instant Velocity</span>
                        <div class="text-xl font-bold text-blue-600">
                            <span id="instSpeedDisplay">100.0</span> <span class="text-xs font-normal text-blue-400">mph</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const canvas = document.getElementById('trainChart');
        const ctx = canvas.getContext('2d');
        const varianceSlider = document.getElementById('varianceSlider');
        const varianceVal = document.getElementById('varianceVal');
        const avgSpeedDisplay = document.getElementById('avgSpeedDisplay');
        const instSpeedDisplay = document.getElementById('instSpeedDisplay');
        const ansA = document.getElementById('ansA');
        const ansB = document.getElementById('ansB');
        const toggleBtn = document.getElementById('toggleScannerBtn');

        // Logic Setup
        let sliderValue = 0;
        let scannerT = 0; 
        let isScannerAnimating = true;
        
        // Resize canvas for crisp rendering
        function resize() {
            canvas.width = canvas.parentElement.offsetWidth * 2;
            canvas.height = canvas.parentElement.offsetHeight * 2;
            ctx.scale(2, 2);
        }
        window.addEventListener('resize', resize);
        resize();

        // Math Constants
        const margin = { top: 30, right: 30, bottom: 30, left: 60 }; // Increased left margin for Y-axis text
        const maxTime = 5.5; 
        const maxDist = 600; 

        // Physics Functions
        // v(t) = 100 + A * sin(2*PI*t)
        // d(t) = 100t + (A/2PI) * (1 - cos(2*PI*t))
        
        function getAmplitude() { return sliderValue * 0.98; }

        function getDistance(t) {
            const A = getAmplitude();
            const term = (A / (2 * Math.PI)); 
            return 100 * t + term * (1 - Math.cos(2 * Math.PI * t));
        }

        function getVelocity(t) {
            const A = getAmplitude();
            return 100 + A * Math.sin(2 * Math.PI * t);
        }

        // Draw Loop
        function draw() {
            // Clear
            const w = canvas.width / 2;
            const h = canvas.height / 2;
            ctx.clearRect(0, 0, w, h);

            // Scales
            const scaleX = (t) => margin.left + (t / maxTime) * (w - margin.left - margin.right);
            const scaleY = (d) => h - margin.bottom - (d / maxDist) * (h - margin.top - margin.bottom);

            // 1. Grid
            ctx.strokeStyle = '#F3F4F6';
            ctx.lineWidth = 1;
            ctx.font = '10px Inter';
            ctx.fillStyle = '#9CA3AF';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            // X Axis
            for (let t = 0; t <= 5; t++) {
                const x = scaleX(t);
                ctx.beginPath(); ctx.moveTo(x, margin.top); ctx.lineTo(x, h - margin.bottom); ctx.stroke();
                ctx.fillText(t + 'h', x, h - margin.bottom + 15);
            }
            // 5.5h Mark
            const xFinal = scaleX(5.5);
            ctx.beginPath(); ctx.moveTo(xFinal, margin.top); ctx.lineTo(xFinal, h - margin.bottom); ctx.stroke();
            ctx.fillText('5.5h', xFinal, h - margin.bottom + 15);

            // Y Axis
            ctx.textAlign = 'right';
            for (let d = 0; d <= maxDist; d += 100) {
                const y = scaleY(d);
                ctx.beginPath(); ctx.moveTo(margin.left, y); ctx.lineTo(w - margin.right, y); ctx.stroke();
                ctx.fillText(d, margin.left - 10, y);
            }

            // 2. Average Speed Line (Red)
            const tTotal = 5.5;
            const dTotal = getDistance(tTotal);
            ctx.beginPath();
            ctx.strokeStyle = '#EF4444';
            ctx.lineWidth = 2;
            ctx.setLineDash([4, 4]);
            ctx.moveTo(scaleX(0), scaleY(0));
            ctx.lineTo(scaleX(tTotal), scaleY(dTotal));
            ctx.stroke();
            ctx.setLineDash([]);

            // 2b. End Point Markers (Distance at 5.5h)
            const xFinalMark = scaleX(tTotal);
            const yFinalMark = scaleY(dTotal);

            ctx.beginPath();
            ctx.strokeStyle = '#DC2626'; 
            ctx.lineWidth = 1;
            ctx.setLineDash([4, 4]);
            
            // Horizontal line to Y-axis
            ctx.moveTo(xFinalMark, yFinalMark);
            ctx.lineTo(margin.left, yFinalMark);
            
            // Vertical line to X-axis
            ctx.moveTo(xFinalMark, yFinalMark);
            ctx.lineTo(xFinalMark, h - margin.bottom);
            ctx.stroke();
            ctx.setLineDash([]);

            // Red Dot at 5.5h
            ctx.beginPath();
            ctx.fillStyle = '#DC2626';
            ctx.arc(xFinalMark, yFinalMark, 4, 0, Math.PI * 2);
            ctx.fill();

            // Distance Label ON Y-AXIS
            ctx.save();
            ctx.font = 'bold 12px Inter';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            // Background box for text clarity
            const text = dTotal.toFixed(1);
            const textWidth = ctx.measureText(text).width;
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)'; // Slightly transparent white
            ctx.fillRect(margin.left - 15 - textWidth, yFinalMark - 8, textWidth + 10, 16);
            
            // Text
            ctx.fillStyle = '#DC2626'; // Red
            ctx.fillText(text, margin.left - 10, yFinalMark);
            ctx.restore();

            // 3. Actual Curve (Blue)
            ctx.beginPath();
            ctx.strokeStyle = '#2563EB'; 
            ctx.lineWidth = 3;
            ctx.lineJoin = 'round';
            for (let px = margin.left; px <= w - margin.right; px++) {
                const t = (px - margin.left) / (w - margin.left - margin.right) * maxTime;
                if (t > maxTime) break;
                const d = getDistance(t);
                if (px === margin.left) ctx.moveTo(px, scaleY(d));
                else ctx.lineTo(px, scaleY(d));
            }
            ctx.stroke();

            // 4. Scanner (Green Box)
            // Scanner represents exactly 1 hour width and 100 miles height
            const tStart = scannerT;
            const tEnd = scannerT + 1;
            
            if (tEnd <= maxTime + 0.1) {
                const xS = scaleX(tStart);
                const xE = scaleX(tEnd);
                const yS = scaleY(getDistance(tStart));
                const yE = scaleY(getDistance(tEnd));

                // Fill Box
                ctx.fillStyle = 'rgba(16, 185, 129, 0.1)'; 
                ctx.strokeStyle = '#10B981'; 
                ctx.lineWidth = 1;
                
                ctx.beginPath();
                ctx.moveTo(xS, yS);
                ctx.lineTo(xE, yS);
                ctx.lineTo(xE, yE);   
                ctx.lineTo(xS, yE); 
                ctx.lineTo(xS, yS); 
                ctx.fill();
                ctx.stroke();

                // Scanner Labels
                ctx.fillStyle = '#059669';
                ctx.font = 'bold 10px Inter';
                ctx.textAlign = 'center';
                ctx.fillText("Δt=1h", (xS+xE)/2, yE - 8);
                ctx.textAlign = 'left';
                ctx.fillText("Δd=100mi", xE + 4, (yS+yE)/2);

                // Train Dot
                ctx.beginPath();
                ctx.fillStyle = '#2563EB';
                ctx.arc(xS, yS, 5, 0, Math.PI*2);
                ctx.fill();

                // UPDATE INSTANT VELOCITY
                const v = getVelocity(tStart);
                instSpeedDisplay.innerText = v.toFixed(0);
            }

            // 5. Update DOM Logic
            const avgSpeed = dTotal / tTotal;
            avgSpeedDisplay.innerText = avgSpeed.toFixed(1);
            
            // Logic Check
            if (Math.abs(sliderValue) > 0) {
                // Paradox is active (Velocity not constant)
                ansA.innerText = "NO";
                ansA.className = "text-sm font-bold bg-red-100 text-red-600 px-3 py-1 rounded";
                
                ansB.innerText = "NO";
                ansB.className = "text-sm font-bold bg-red-100 text-red-600 px-3 py-1 rounded";

                avgSpeedDisplay.className = "text-red-600";
            } else {
                // Uniform motion
                ansA.innerText = "YES";
                ansA.className = "text-sm font-bold bg-green-100 text-green-600 px-3 py-1 rounded";
                
                ansB.innerText = "YES";
                ansB.className = "text-sm font-bold bg-green-100 text-green-600 px-3 py-1 rounded";
                
                avgSpeedDisplay.className = "text-slate-900";
            }
        }

        // Loop
        function loop() {
            if (isScannerAnimating) {
                scannerT += 0.005;
                if (scannerT > 4.5) scannerT = 0;
            }
            draw();
            requestAnimationFrame(loop);
        }

        // Listeners
        varianceSlider.addEventListener('input', (e) => {
            sliderValue = parseFloat(e.target.value);
            varianceVal.innerText = Math.abs(sliderValue) + "%";
        });

        toggleBtn.addEventListener('click', () => {
            isScannerAnimating = !isScannerAnimating;
            toggleBtn.innerText = isScannerAnimating ? "Pause" : "Resume";
        });

        loop();

    </script>
</body>
</html>
